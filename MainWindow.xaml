<Window x:Class="BatchImage_Studio.MainWindow"
        xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
        xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
        Title="Image &amp; PDF Batch Studio" 
        Height="760" Width="1200"
        MinWidth="1050" MinHeight="680"
        WindowStartupLocation="CenterScreen"
        WindowStyle="SingleBorderWindow" 
        AllowsTransparency="False" 
        Background="#1E1E1E"
        FontFamily="Segoe UI Variable"
        Loaded="Window_Loaded" Closing="Window_Closing">

    <WindowChrome.WindowChrome>
        <WindowChrome CaptionHeight="35" ResizeBorderThickness="7" GlassFrameThickness="0" UseAeroCaptionButtons="False" CornerRadius="0"/>
    </WindowChrome.WindowChrome>

    <Window.Resources>
        <Style TargetType="ScrollViewer">
            <Setter Property="Template">
                <Setter.Value>
                    <ControlTemplate TargetType="ScrollViewer">
                        <Grid Background="{TemplateBinding Background}">
                            <Grid.ColumnDefinitions>
                                <ColumnDefinition Width="*"/>
                                <ColumnDefinition Width="Auto"/>
                            </Grid.ColumnDefinitions>
                            <Grid.RowDefinitions>
                                <RowDefinition Height="*"/>
                                <RowDefinition Height="Auto"/>
                            </Grid.RowDefinitions>
                            <ScrollContentPresenter x:Name="PART_ScrollContentPresenter" Grid.Column="0" Grid.Row="0"/>
                            <ScrollBar x:Name="PART_VerticalScrollBar" Grid.Column="1" Grid.Row="0" Value="{TemplateBinding VerticalOffset}" Maximum="{TemplateBinding ScrollableHeight}" ViewportSize="{TemplateBinding ViewportHeight}" Visibility="{TemplateBinding ComputedVerticalScrollBarVisibility}"/>
                            <ScrollBar x:Name="PART_HorizontalScrollBar" Orientation="Horizontal" Grid.Column="0" Grid.Row="1" Value="{TemplateBinding HorizontalOffset}" Maximum="{TemplateBinding ScrollableWidth}" ViewportSize="{TemplateBinding ViewportWidth}" Visibility="{TemplateBinding ComputedHorizontalScrollBarVisibility}"/>
                            <Rectangle Grid.Column="1" Grid.Row="1" Fill="#1E1E1E"/>
                        </Grid>
                    </ControlTemplate>
                </Setter.Value>
            </Setter>
        </Style>

        <Style TargetType="ScrollBar">
            <Setter Property="Background" Value="#1E1E1E"/>
            <Setter Property="BorderBrush" Value="#3E3E42"/>
            <Setter Property="Width" Value="12"/>
            <Setter Property="Template">
                <Setter.Value>
                    <ControlTemplate TargetType="ScrollBar">
                        <Grid Background="{TemplateBinding Background}">
                            <Track Name="PART_Track" IsDirectionReversed="true">
                                <Track.Thumb>
                                    <Thumb>
                                        <Thumb.Template>
                                            <ControlTemplate TargetType="Thumb">
                                                <Border Background="#3E3E42" CornerRadius="4" Margin="2"/>
                                            </ControlTemplate>
                                        </Thumb.Template>
                                    </Thumb>
                                </Track.Thumb>
                            </Track>
                        </Grid>
                    </ControlTemplate>
                </Setter.Value>
            </Setter>
            <Style.Triggers>
                <Trigger Property="Orientation" Value="Horizontal">
                    <Setter Property="Height" Value="12"/>
                    <Setter Property="Width" Value="Auto"/>
                </Trigger>
            </Style.Triggers>
        </Style>

        <Style TargetType="CheckBox">
            <Setter Property="Foreground" Value="White"/>
            <Setter Property="VerticalContentAlignment" Value="Center"/>
            <Setter Property="Template">
                <Setter.Value>
                    <ControlTemplate TargetType="CheckBox">
                        <StackPanel Orientation="Horizontal">
                            <Border x:Name="Border" Width="18" Height="18" Background="#3E3E42" BorderBrush="#555555" BorderThickness="1" CornerRadius="3">
                                <Path x:Name="CheckMark" Fill="White" Data="M 4 9 L 8 13 L 14 4 L 12 2 L 7 9 L 5 7 Z" Visibility="Collapsed" Stretch="Fill" Margin="2"/>
                            </Border>
                            <ContentPresenter Margin="8,0,0,0" VerticalAlignment="Center"/>
                        </StackPanel>
                        <ControlTemplate.Triggers>
                            <Trigger Property="IsChecked" Value="True">
                                <Setter TargetName="CheckMark" Property="Visibility" Value="Visible"/>
                                <Setter TargetName="Border" Property="Background" Value="#0078D4"/>
                                <Setter TargetName="Border" Property="BorderBrush" Value="#0078D4"/>
                            </Trigger>
                            <Trigger Property="IsEnabled" Value="False">
                                <Setter Property="Opacity" Value="0.5"/>
                            </Trigger>
                        </ControlTemplate.Triggers>
                    </ControlTemplate>
                </Setter.Value>
            </Setter>
        </Style>

        <Style TargetType="RadioButton">
            <Setter Property="Foreground" Value="White"/>
            <Setter Property="VerticalContentAlignment" Value="Center"/>
            <Setter Property="Template">
                <Setter.Value>
                    <ControlTemplate TargetType="RadioButton">
                        <StackPanel Orientation="Horizontal">
                            <Border x:Name="Border" Width="18" Height="18" Background="#3E3E42" BorderBrush="#555555" BorderThickness="1" CornerRadius="9">
                                <Ellipse x:Name="Dot" Fill="White" Width="8" Height="8" Visibility="Collapsed"/>
                            </Border>
                            <ContentPresenter Margin="8,0,0,0" VerticalAlignment="Center"/>
                        </StackPanel>
                        <ControlTemplate.Triggers>
                            <Trigger Property="IsChecked" Value="True">
                                <Setter TargetName="Dot" Property="Visibility" Value="Visible"/>
                                <Setter TargetName="Border" Property="Background" Value="#0078D4"/>
                                <Setter TargetName="Border" Property="BorderBrush" Value="#0078D4"/>
                            </Trigger>
                        </ControlTemplate.Triggers>
                    </ControlTemplate>
                </Setter.Value>
            </Setter>
        </Style>

        <Style TargetType="ToggleButton">
            <Setter Property="Background" Value="#3E3E42"/>
            <Setter Property="Foreground" Value="White"/>
            <Setter Property="BorderBrush" Value="#555555"/>
            <Setter Property="Cursor" Value="Hand"/>
            <Setter Property="Template">
                <Setter.Value>
                    <ControlTemplate TargetType="ToggleButton">
                        <Border Background="{TemplateBinding Background}" BorderBrush="{TemplateBinding BorderBrush}" BorderThickness="1" CornerRadius="3">
                            <ContentPresenter HorizontalAlignment="Center" VerticalAlignment="Center"/>
                        </Border>
                        <ControlTemplate.Triggers>
                            <Trigger Property="IsChecked" Value="True">
                                <Setter Property="Background" Value="#0078D4"/>
                                <Setter Property="BorderBrush" Value="#0078D4"/>
                            </Trigger>
                            <Trigger Property="IsMouseOver" Value="True">
                                <Setter Property="Background" Value="#505050"/>
                            </Trigger>
                        </ControlTemplate.Triggers>
                    </ControlTemplate>
                </Setter.Value>
            </Setter>
        </Style>

        <Style TargetType="Slider">
            <Setter Property="Opacity" Value="1"/>
            <Setter Property="Template">
                <Setter.Value>
                    <ControlTemplate TargetType="Slider">
                        <Border Background="Transparent" Height="24">
                            <Grid VerticalAlignment="Center">
                                <Border Height="4" Background="#3E3E42" CornerRadius="2" Margin="7,0"/>
                                <Track x:Name="PART_Track">
                                    <Track.DecreaseRepeatButton>
                                        <RepeatButton Command="{x:Static Slider.DecreaseLarge}">
                                            <RepeatButton.Template>
                                                <ControlTemplate TargetType="RepeatButton">
                                                    <Border Height="4" Background="#0078D4" CornerRadius="2,0,0,2"/>
                                                </ControlTemplate>
                                            </RepeatButton.Template>
                                        </RepeatButton>
                                    </Track.DecreaseRepeatButton>
                                    <Track.IncreaseRepeatButton>
                                        <RepeatButton Command="{x:Static Slider.IncreaseLarge}">
                                            <RepeatButton.Template>
                                                <ControlTemplate TargetType="RepeatButton">
                                                    <Border Background="Transparent"/>
                                                </ControlTemplate>
                                            </RepeatButton.Template>
                                        </RepeatButton>
                                    </Track.IncreaseRepeatButton>
                                    <Track.Thumb>
                                        <Thumb>
                                            <Thumb.Template>
                                                <ControlTemplate TargetType="Thumb">
                                                    <Ellipse Width="16" Height="16" Fill="#0078D4" Stroke="White" StrokeThickness="2" Cursor="Hand"/>
                                                </ControlTemplate>
                                            </Thumb.Template>
                                        </Thumb>
                                    </Track.Thumb>
                                </Track>
                            </Grid>
                        </Border>
                    </ControlTemplate>
                </Setter.Value>
            </Setter>
            <Style.Triggers>
                <Trigger Property="IsEnabled" Value="False">
                    <Setter Property="Opacity" Value="0.4"/>
                </Trigger>
            </Style.Triggers>
        </Style>

        <Style TargetType="ComboBox">
            <Setter Property="Foreground" Value="White"/>
            <Setter Property="Background" Value="#3E3E42"/>
            <Setter Property="BorderBrush" Value="#555555"/>
            <Setter Property="BorderThickness" Value="1"/>
            <Setter Property="Padding" Value="10,5"/>
            <Setter Property="Template">
                <Setter.Value>
                    <ControlTemplate TargetType="ComboBox">
                        <Grid>
                            <ToggleButton Name="ToggleButton" Focusable="false" IsChecked="{Binding Path=IsDropDownOpen,Mode=TwoWay,RelativeSource={RelativeSource TemplatedParent}}" ClickMode="Press">
                                <ToggleButton.Template>
                                    <ControlTemplate TargetType="ToggleButton">
                                        <Border Background="{TemplateBinding Background}" BorderBrush="{TemplateBinding BorderBrush}" BorderThickness="1" CornerRadius="3">
                                            <Path x:Name="Arrow" Fill="#A0A0A0" HorizontalAlignment="Right" VerticalAlignment="Center" Margin="0,0,10,0" Data="M 0 0 L 4 4 L 8 0 Z"/>
                                        </Border>
                                    </ControlTemplate>
                                </ToggleButton.Template>
                            </ToggleButton>
                            <ContentPresenter Name="ContentSite" IsHitTestVisible="False" Content="{TemplateBinding SelectionBoxItem}" Margin="{TemplateBinding Padding}" VerticalAlignment="Center" HorizontalAlignment="Left" />
                            <Popup Name="Popup" Placement="Bottom" IsOpen="{TemplateBinding IsDropDownOpen}" AllowsTransparency="True" Focusable="False">
                                <Border Name="DropDown" MinWidth="{TemplateBinding ActualWidth}" MaxHeight="200" Background="#2D2D30" BorderThickness="1" BorderBrush="#555555" CornerRadius="3" Margin="0,2,0,0">
                                    <ScrollViewer Margin="0,5">
                                        <StackPanel IsItemsHost="True" KeyboardNavigation.DirectionalNavigation="Contained" />
                                    </ScrollViewer>
                                </Border>
                            </Popup>
                        </Grid>
                    </ControlTemplate>
                </Setter.Value>
            </Setter>
        </Style>

        <Style TargetType="ComboBoxItem">
            <Setter Property="Background" Value="Transparent"/>
            <Setter Property="Foreground" Value="White"/>
            <Setter Property="Padding" Value="10,5"/>
            <Setter Property="Template">
                <Setter.Value>
                    <ControlTemplate TargetType="ComboBoxItem">
                        <Border Background="{TemplateBinding Background}">
                            <ContentPresenter Margin="{TemplateBinding Padding}"/>
                        </Border>
                        <ControlTemplate.Triggers>
                            <Trigger Property="IsMouseOver" Value="True">
                                <Setter Property="Background" Value="#3E3E42"/>
                            </Trigger>
                            <Trigger Property="IsSelected" Value="True">
                                <Setter Property="Background" Value="#0078D4"/>
                            </Trigger>
                        </ControlTemplate.Triggers>
                    </ControlTemplate>
                </Setter.Value>
            </Setter>
        </Style>

        <Style TargetType="Button">
            <Setter Property="Background" Value="#3E3E42"/>
            <Setter Property="Foreground" Value="White"/>
            <Setter Property="BorderThickness" Value="1"/>
            <Setter Property="BorderBrush" Value="#555555"/>
            <Setter Property="Cursor" Value="Hand"/>
            <Setter Property="Template">
                <Setter.Value>
                    <ControlTemplate TargetType="Button">
                        <Border Background="{TemplateBinding Background}" BorderBrush="{TemplateBinding BorderBrush}" BorderThickness="{TemplateBinding BorderThickness}" CornerRadius="3">
                            <ContentPresenter HorizontalAlignment="Center" VerticalAlignment="Center" Margin="{TemplateBinding Padding}"/>
                        </Border>
                        <ControlTemplate.Triggers>
                            <Trigger Property="IsMouseOver" Value="True">
                                <Setter Property="Background" Value="#505050"/>
                            </Trigger>
                            <Trigger Property="IsPressed" Value="True">
                                <Setter Property="Background" Value="#0078D4"/>
                            </Trigger>
                            <Trigger Property="IsEnabled" Value="False">
                                <Setter Property="Opacity" Value="0.4"/>
                            </Trigger>
                        </ControlTemplate.Triggers>
                    </ControlTemplate>
                </Setter.Value>
            </Setter>
        </Style>

        <Style x:Key="WindowBtnStyle" TargetType="Button">
            <Setter Property="Background" Value="Transparent"/>
            <Setter Property="Foreground" Value="Gray"/>
            <Setter Property="BorderThickness" Value="0"/>
            <Setter Property="Template">
                <Setter.Value>
                    <ControlTemplate TargetType="Button">
                        <Border Background="{TemplateBinding Background}">
                            <ContentPresenter HorizontalAlignment="Center" VerticalAlignment="Center"/>
                        </Border>
                        <ControlTemplate.Triggers>
                            <Trigger Property="IsMouseOver" Value="True">
                                <Setter Property="Background" Value="#3E3E42"/>
                                <Setter Property="Foreground" Value="White"/>
                            </Trigger>
                        </ControlTemplate.Triggers>
                    </ControlTemplate>
                </Setter.Value>
            </Setter>
        </Style>

        <Style x:Key="CloseBtnStyle" TargetType="Button" BasedOn="{StaticResource WindowBtnStyle}">
            <Style.Triggers>
                <Trigger Property="IsMouseOver" Value="True">
                    <Setter Property="Background" Value="#E81123"/>
                    <Setter Property="Foreground" Value="White"/>
                </Trigger>
            </Style.Triggers>
        </Style>
    </Window.Resources>

    <Border x:Name="MainBorder" Background="#1E1E1E" BorderBrush="#3E3E42" BorderThickness="1">
        <Grid>
            <Grid.RowDefinitions>
                <RowDefinition Height="35"/>
                <RowDefinition Height="*"/>
            </Grid.RowDefinitions>

            <Grid Grid.Row="0" Background="Transparent">
                <StackPanel Orientation="Horizontal" HorizontalAlignment="Left" VerticalAlignment="Center" Margin="15,0,0,0">
                    <Image Source="BtachImage_1.ico" Width="20" Height="20" Margin="0,0,10,0"/>
                    <TextBlock Text="Batch Image Date" Foreground="#4DA8DA" FontWeight="SemiBold" VerticalAlignment="Center"/>
                </StackPanel>

                <StackPanel Orientation="Horizontal" HorizontalAlignment="Right" Margin="0,0,5,0" WindowChrome.IsHitTestVisibleInChrome="True">
                    <Button Content="—" Width="35" Style="{StaticResource WindowBtnStyle}" Click="BtnMinimize_Click"/>
                    <Button Content="🗖" Width="35" Style="{StaticResource WindowBtnStyle}" Click="BtnMaximize_Click"/>
                    <Button Content="✕" Width="35" Style="{StaticResource CloseBtnStyle}" Click="BtnClose_Click"/>
                </StackPanel>
            </Grid>

            <Grid Grid.Row="1" Margin="15,0,15,15">
                <Grid.ColumnDefinitions>
                    <ColumnDefinition Width="680"/>
                    <ColumnDefinition Width="*"/>
                </Grid.ColumnDefinitions>

                <Grid Grid.Column="0" Margin="0,0,10,0">
                    <Grid.RowDefinitions>
                        <RowDefinition Height="Auto"/>
                        <RowDefinition Height="*"/>
                    </Grid.RowDefinitions>

                    <Grid Grid.Row="0">
                        <Grid.ColumnDefinitions>
                            <ColumnDefinition Width="320"/>
                            <ColumnDefinition Width="350"/>
                        </Grid.ColumnDefinitions>

                        <Border Grid.Column="0" Background="#2D2D30" CornerRadius="10" Padding="15" Margin="0,0,10,10">
                            <StackPanel>
                                <TextBlock Text="⚙ Watermark Settings" FontSize="20" FontWeight="SemiBold" Margin="0,0,0,15" Foreground="#4DA8DA"/>

                                <TextBlock Text="Date Source:" Margin="0,0,0,5" Foreground="LightGray"/>
                                <CheckBox x:Name="ChkUseExif" Content="Use EXIF Metadata" IsChecked="True" Margin="0,0,0,10" Checked="LivePreview_Trigger" Unchecked="LivePreview_Trigger"/>

                                <TextBox x:Name="TxtCustomDate" Text="2024-01-01" Foreground="White" Background="#3E3E42" BorderBrush="#555555" Padding="5" Margin="0,0,0,20" TextChanged="LivePreview_Trigger">
                                    <TextBox.Style>
                                        <Style TargetType="TextBox">
                                            <Setter Property="IsEnabled" Value="True"/>
                                            <Setter Property="Opacity" Value="1"/>
                                            <Style.Triggers>
                                                <DataTrigger Binding="{Binding IsChecked, ElementName=ChkUseExif}" Value="True">
                                                    <Setter Property="IsEnabled" Value="False"/>
                                                    <Setter Property="Opacity" Value="0.4"/>
                                                </DataTrigger>
                                            </Style.Triggers>
                                        </Style>
                                    </TextBox.Style>
                                </TextBox>

                                <Border Background="#1E1E1E" CornerRadius="5" Padding="10" Margin="0,0,0,20" BorderBrush="#3E3E42" BorderThickness="1">
                                    <StackPanel>
                                        <TextBlock Text="📁 Import Images" FontWeight="SemiBold" Foreground="#4DA8DA" Margin="0,0,0,10"/>
                                        <Grid>
                                            <Grid.ColumnDefinitions>
                                                <ColumnDefinition Width="*"/>
                                                <ColumnDefinition Width="70"/>
                                            </Grid.ColumnDefinitions>
                                            <TextBox x:Name="TxtInputFolder" Grid.Column="0" Foreground="Gray" Background="#3E3E42" BorderBrush="#555555" Padding="5" Margin="0,0,5,0" TextChanged="TxtInputFolder_TextChanged"/>
                                            <Button x:Name="BtnBrowse" Grid.Column="1" Content="Browse" Padding="5" Click="BtnBrowse_Click"/>
                                        </Grid>
                                        <CheckBox x:Name="ChkDeepSearch" Content="Deep Search (Subfolders)" Margin="0,10,0,0" Foreground="LightGray"/>
                                    </StackPanel>
                                </Border>

                                <TextBlock Text="Font &amp; Style:" Margin="0,0,0,5" Foreground="LightGray"/>
                                <Grid Margin="0,0,0,10">
                                    <Grid.ColumnDefinitions>
                                        <ColumnDefinition Width="*"/>
                                        <ColumnDefinition Width="35"/>
                                        <ColumnDefinition Width="35"/>
                                    </Grid.ColumnDefinitions>
                                    <ComboBox x:Name="ComboFont" SelectedIndex="0" Margin="0,0,5,0" SelectionChanged="LivePreview_Trigger">
                                        <ComboBoxItem Content="Arial"/>
                                        <ComboBoxItem Content="Segoe UI"/>
                                        <ComboBoxItem Content="Times New Roman"/>
                                    </ComboBox>
                                    <ToggleButton x:Name="BtnBold" Grid.Column="1" Content="B" FontWeight="Bold" Margin="0,0,5,0" Checked="LivePreview_Trigger" Unchecked="LivePreview_Trigger"/>
                                    <ToggleButton x:Name="BtnItalic" Grid.Column="2" Content="I" FontStyle="Italic" FontFamily="Serif" Checked="LivePreview_Trigger" Unchecked="LivePreview_Trigger"/>
                                </Grid>

                                <Grid Margin="0,0,0,15">
                                    <Grid.ColumnDefinitions>
                                        <ColumnDefinition Width="*"/>
                                        <ColumnDefinition Width="*"/>
                                    </Grid.ColumnDefinitions>
                                    <StackPanel Grid.Column="0" Margin="0,0,5,0">
                                        <TextBlock Text="Size (Level 1-10):" Margin="0,0,0,5" Foreground="LightGray"/>
                                        <Slider x:Name="SizeSlider" Minimum="1" Maximum="10" Value="5" TickFrequency="1" IsSnapToTickEnabled="True" ValueChanged="LivePreview_Trigger" Margin="0,5,0,0"/>
                                    </StackPanel>
                                    <StackPanel Grid.Column="1">
                                        <TextBlock Text="Position:" Margin="0,0,0,5" Foreground="LightGray"/>
                                        <ComboBox x:Name="ComboPosition" SelectedIndex="0" SelectionChanged="LivePreview_Trigger">
                                            <ComboBoxItem Content="Bottom Right"/>
                                            <ComboBoxItem Content="Bottom Left"/>
                                            <ComboBoxItem Content="Top Right"/>
                                            <ComboBoxItem Content="Top Left"/>
                                            <ComboBoxItem Content="Center"/>
                                        </ComboBox>
                                    </StackPanel>
                                </Grid>

                                <Grid Margin="0,0,0,10">
                                    <Grid.ColumnDefinitions>
                                        <ColumnDefinition Width="Auto"/>
                                        <ColumnDefinition Width="*"/>
                                        <ColumnDefinition Width="40"/>
                                    </Grid.ColumnDefinitions>
                                    <TextBlock Grid.Column="0" Text="Text Color:" Foreground="LightGray" VerticalAlignment="Center"/>
                                    <Border Grid.Column="2" x:Name="TextColorBlock" Background="White" BorderBrush="#555555" BorderThickness="1" CornerRadius="3" Height="25" Cursor="Hand" MouseLeftButtonDown="ColorBlock_Click"/>
                                </Grid>

                                <Grid>
                                    <Grid.RowDefinitions>
                                        <RowDefinition Height="Auto"/>
                                        <RowDefinition Height="Auto"/>
                                    </Grid.RowDefinitions>
                                    <Grid Grid.Row="0">
                                        <Grid.ColumnDefinitions>
                                            <ColumnDefinition Width="Auto"/>
                                            <ColumnDefinition Width="*"/>
                                            <ColumnDefinition Width="40"/>
                                        </Grid.ColumnDefinitions>
                                        <CheckBox Grid.Column="0" x:Name="StrokeCheck" Content="Enable Stroke" VerticalAlignment="Center" Checked="LivePreview_Trigger" Unchecked="LivePreview_Trigger"/>
                                        <Border Grid.Column="2" x:Name="StrokeColorBlock" Background="Black" BorderBrush="#555555" BorderThickness="1" CornerRadius="3" Height="25" Cursor="Hand" MouseLeftButtonDown="ColorBlock_Click" IsEnabled="{Binding IsChecked, ElementName=StrokeCheck}"/>
                                    </Grid>

                                    <StackPanel Grid.Row="1" Margin="0,10,0,0" IsEnabled="{Binding IsChecked, ElementName=StrokeCheck}">
                                        <TextBlock Text="Stroke Thickness:" Foreground="Gray" FontSize="11" Margin="0,0,0,5"/>
                                        <Slider x:Name="StrokeThicknessSlider" Minimum="1" Maximum="10" Value="3" ValueChanged="LivePreview_Trigger"/>
                                    </StackPanel>
                                </Grid>
                            </StackPanel>
                        </Border>

                        <Border Grid.Column="1" Background="#2D2D30" CornerRadius="10" Padding="15" Margin="0,0,0,10">
                            <StackPanel>
                                <TextBlock Text="📦 Optimization &amp; Output" FontSize="20" FontWeight="SemiBold" Margin="0,0,0,15" Foreground="#4DA8DA"/>

                                <TextBlock Text="Image Processing:" Margin="0,0,0,5" Foreground="LightGray"/>
                                <CheckBox x:Name="ChkConvertJpeg" Content="Convert all formats to JPEG" Margin="0,0,0,10" Foreground="#4DA8DA"/>

                                <StackPanel Orientation="Horizontal" Margin="0,0,0,10">
                                    <CheckBox x:Name="ChkResize" Content="Resize if larger than " VerticalAlignment="Center"/>
                                    <TextBox x:Name="TxtMaxSize" Text="5" Width="40" Background="#3E3E42" Foreground="White" BorderBrush="#555555" TextAlignment="Center" Margin="5,0"/>
                                    <TextBlock Text="MB" Foreground="White" VerticalAlignment="Center"/>
                                </StackPanel>

                                <CheckBox x:Name="CompressCheck" Content="Compress JPEG Quality" Margin="0,0,0,5"/>
                                <StackPanel Orientation="Horizontal" Margin="0,0,0,15" IsEnabled="{Binding IsChecked, ElementName=CompressCheck}">
                                    <Slider x:Name="QualitySlider" Width="240" Minimum="10" Maximum="100" Value="80" Margin="0,0,10,0"/>
                                    <TextBlock Text="{Binding Value, ElementName=QualitySlider, StringFormat={}{0:0}%}" Foreground="White" FontWeight="Bold" VerticalAlignment="Center"/>
                                </StackPanel>

                                <Separator Background="#3E3E42" Margin="0,0,0,15"/>

                                <TextBlock Text="Export Format:" Margin="0,0,0,5" Foreground="LightGray"/>
                                <RadioButton GroupName="ExportFormat" x:Name="FormatImage" Content="Standard Images" IsChecked="True" Margin="0,0,0,5" Checked="ExportFormat_Changed"/>
                                <RadioButton GroupName="ExportFormat" x:Name="FormatSinglePdf" Content="Single PDFs (1 File = 1 Photo)" Margin="0,0,0,5" Checked="ExportFormat_Changed"/>
                                <RadioButton GroupName="ExportFormat" x:Name="FormatMultiPdf" Content="Multipage PDF (All in One)" Margin="0,0,0,10" Checked="ExportFormat_Changed"/>

                                <StackPanel Margin="0,0,0,15">
                                    <StackPanel.Style>
                                        <Style TargetType="StackPanel">
                                            <Setter Property="Visibility" Value="Collapsed"/>
                                            <Style.Triggers>
                                                <DataTrigger Binding="{Binding IsChecked, ElementName=FormatMultiPdf}" Value="True">
                                                    <Setter Property="Visibility" Value="Visible"/>
                                                </DataTrigger>
                                            </Style.Triggers>
                                        </Style>
                                    </StackPanel.Style>
                                    <TextBlock Text="PDF File Name:" Margin="0,0,0,5" Foreground="LightGray" FontSize="11"/>
                                    <TextBox x:Name="TxtPdfFileName" Text="BatchExport_Multi" Foreground="White" Background="#3E3E42" BorderBrush="#555555" Padding="5"/>
                                </StackPanel>

                                <TextBlock Text="Destination:" Margin="0,0,0,5" Foreground="LightGray"/>
                                <RadioButton GroupName="Destination" x:Name="RadioReplace" Content="Replace existing pictures" Margin="0,0,0,5" IsEnabled="{Binding IsChecked, ElementName=FormatImage}"/>
                                <RadioButton GroupName="Destination" x:Name="RadioOriginalFolder" Content="Save in original folder" IsChecked="True" Margin="0,0,0,5"/>
                                <RadioButton GroupName="Destination" x:Name="RadioCustomDir" Content="Custom Directory" Margin="0,0,0,5"/>

                                <Grid Margin="0,0,0,15" IsEnabled="{Binding IsChecked, ElementName=RadioCustomDir}">
                                    <Grid.ColumnDefinitions>
                                        <ColumnDefinition Width="*"/>
                                        <ColumnDefinition Width="Auto"/>
                                    </Grid.ColumnDefinitions>
                                    <TextBox x:Name="TxtOutputDir" Grid.Column="0" Text="C:\Output..." Foreground="Gray" Background="#3E3E42" BorderBrush="#555555" Padding="5" Margin="0,0,5,0"/>
                                    <Button x:Name="BtnCustomOutputDir" Grid.Column="1" Content="..." Width="30" Padding="5" Click="BtnCustomOutputDir_Click"/>
                                </Grid>

                                <Button x:Name="BtnStartProcess" Content="▶ START BATCH PROCESS" Background="#4DA8DA" Foreground="White" BorderThickness="0" Height="45" FontSize="14" FontWeight="Bold" Margin="0,10,0,10" Click="BtnStartProcess_Click"/>

                                <ProgressBar x:Name="ProgressBarIndicator" Value="0" Height="8" BorderThickness="0" Foreground="#4DA8DA" Background="#1E1E1E"/>
                                <TextBlock x:Name="TxtProgressText" Text="Ready to process!" HorizontalAlignment="Center" FontSize="11" Margin="0,5,0,0" Foreground="Gray"/>
                            </StackPanel>
                        </Border>
                    </Grid>

                    <Border Grid.Row="1" Background="#2D2D30" CornerRadius="10" Padding="10" AllowDrop="True" Drop="ListBox_Drop">
                        <Grid>
                            <Grid.ColumnDefinitions>
                                <ColumnDefinition Width="*"/>
                                <ColumnDefinition Width="40"/>
                                <ColumnDefinition Width="*"/>
                            </Grid.ColumnDefinitions>

                            <Grid Grid.Column="0">
                                <Grid.RowDefinitions>
                                    <RowDefinition Height="Auto"/>
                                    <RowDefinition Height="*"/>
                                </Grid.RowDefinitions>
                                <TextBlock Text="Excluded Files" Foreground="LightGray" Margin="0,0,0,5"/>
                                <ListBox Grid.Row="1" x:Name="ExcludedFilesList" SelectionMode="Extended" Background="#1E1E1E" BorderBrush="#555555" Foreground="White" 
                                        ScrollViewer.VerticalScrollBarVisibility="Auto" 
                                        ScrollViewer.HorizontalScrollBarVisibility="Auto" 
                                        SelectionChanged="ExcludedFilesList_SelectionChanged" KeyDown="ListBox_KeyDown"/>
                            </Grid>

                            <StackPanel Grid.Column="1" VerticalAlignment="Center" HorizontalAlignment="Center">
                                <Button x:Name="BtnAddFiles" Content="▶" Width="20" Height="20" Margin="0,15,0,10" ToolTip="Add back to Process Queue" Click="BtnAddFiles_Click"/>
                                <Button x:Name="BtnRemoveFiles" Content="◀" Width="20" Height="20" ToolTip="Exclude from Queue" Click="BtnRemoveFiles_Click"/>
                            </StackPanel>

                            <Grid Grid.Column="2">
                                <Grid.RowDefinitions>
                                    <RowDefinition Height="Auto"/>
                                    <RowDefinition Height="*"/>
                                </Grid.RowDefinitions>
                                <TextBlock x:Name="TxtReadyCount" Text="Ready to Process (0)" Foreground="#4DA8DA" Margin="0,0,0,5" FontWeight="SemiBold"/>
                                <ListBox Grid.Row="1" x:Name="ReadyFilesList" SelectionMode="Extended" Background="#1E1E1E" BorderBrush="#555555" Foreground="White" 
                                        ScrollViewer.VerticalScrollBarVisibility="Auto" 
                                        ScrollViewer.HorizontalScrollBarVisibility="Auto" 
                                        SelectionChanged="ReadyFilesList_SelectionChanged" KeyDown="ListBox_KeyDown"/>
                            </Grid>
                        </Grid>
                    </Border>
                </Grid>

                <Border Grid.Column="1" Background="#2D2D30" CornerRadius="10" Padding="10" ClipToBounds="True">
                    <Grid>
                        <StackPanel Orientation="Horizontal" VerticalAlignment="Top" HorizontalAlignment="Left" Panel.ZIndex="3">
                            <TextBlock Text="👁 Live Preview" FontWeight="SemiBold" Foreground="#4DA8DA" Margin="0,0,15,0"/>
                            <Button x:Name="BtnRotate" Content="↻" Width="25" Height="25" Margin="0,0,5,0" ToolTip="Rotate 90°" Click="BtnRotate_Click" Background="#3E3E42" BorderThickness="0" Foreground="White" FontSize="16"/>

                            <Button x:Name="BtnZoomExtend" Content="🏠" Width="25" Height="25" Margin="0,0,5,0" ToolTip="Zoom Extend" Click="BtnZoomExtend_Click" Background="#3E3E42" BorderThickness="0"/>
                            <Slider x:Name="ZoomSlider" Width="100" Minimum="1" Maximum="10" Value="1" VerticalAlignment="Center" Margin="5,0"/>
                            <TextBlock Text="{Binding Value, ElementName=ZoomSlider, StringFormat={}{0:0}x}" Foreground="Gray" FontSize="10" VerticalAlignment="Center" Margin="5,0"/>
                        </StackPanel>
                        <TextBlock x:Name="TxtPreviewHint" Text="Select a photo from the lists below" FontSize="16" Foreground="Gray" VerticalAlignment="Center" HorizontalAlignment="Center"/>

                        <Border x:Name="PreviewClipContainer" Margin="0,35,0,0" ClipToBounds="True" Background="#1A1A1A">
                            <Grid x:Name="ZoomContainer" RenderTransformOrigin="0.5,0.5" Background="Transparent"
                                  MouseWheel="ZoomContainer_MouseWheel" MouseLeftButtonDown="ZoomContainer_MouseLeftButtonDown"
                                  MouseLeftButtonUp="ZoomContainer_MouseLeftButtonUp" MouseMove="ZoomContainer_MouseMove">

                                <Grid.RenderTransform>
                                    <TransformGroup>
                                        <ScaleTransform ScaleX="{Binding Value, ElementName=ZoomSlider}" ScaleY="{Binding Value, ElementName=ZoomSlider}"/>
                                        <TranslateTransform x:Name="PanTransform" X="0" Y="0"/>
                                    </TransformGroup>
                                </Grid.RenderTransform>

                                <Viewbox Stretch="Uniform" HorizontalAlignment="Center" VerticalAlignment="Center">
                                    <Grid x:Name="InternalImageCanvas">
                                        <Image x:Name="ImgPreview" Stretch="Fill" 
                                               Width="{Binding Width, ElementName=InternalImageCanvas}" 
                                               Height="{Binding Height, ElementName=InternalImageCanvas}"/>

                                        <Grid x:Name="WatermarkGrid" HorizontalAlignment="Stretch" VerticalAlignment="Stretch"/>

                                        <Border x:Name="ExcludedWarningOverlay" Background="#D8000000" Visibility="Collapsed">
                                            <TextBlock Text="🚫 Excluded" Foreground="#FF5555" FontSize="40" FontWeight="Bold" VerticalAlignment="Center" HorizontalAlignment="Center"/>
                                        </Border>
                                    </Grid>
                                </Viewbox>
                            </Grid>
                        </Border>
                    </Grid>
                </Border>
            </Grid>
        </Grid>
    </Border>
</Window>